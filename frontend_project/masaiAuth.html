<!DOCTYPE html>
<html>

<head>
    <title>
        ES6 - II
    </title>
    <style>
        .forms{
            display: flex;
            align-items: center;
        }
        .forms>div{
            width: 400px;
            padding-left: 100px;
        }
        .logout{
            margin: 20px;
            padding: 10px;
            font-size: 20px;
            background-color: red;
            color: white;
        }
    </style>
</head>

<body>
    <h1>Masai Authenication</h1>


    <div class="forms">
        <div id="register">
            <h1>Register</h1>
            <form onsubmit="Register(event)">
                name:<br> <input type="text" id="inp1" /><br>
                email:<br> <input type="text" id="inp2" /><br>
                password:<br> <input type="password" id="inp3" /><br>
                username:<br> <input type="text" id="inp4" /><br>
                mobile:<br> <input type="text" id="inp5" /><br>
                description:<br> <input type="text" id="inp6" /><br>
                <input type="submit" />
        
        
            </form>
        </div>
        
        <div id="login">
            <h1>Login</h1>
            <form onsubmit="Login(event)">
                username:<br> <input type="text" id="inp7" /><br>
                password:<br> <input type="password" id="inp8" /><br>
                <input type="submit" />
            </form>
        </div>
    </div>

    <div><button class="logout" onclick="logOut()">Log Out</button></div>

    

</body>

</html>
<script>
    var x =10;
    console.log(x);

    // function Register(e) {
    //     e.preventDefault();

    //     let formdata = {
    //         name:document.getElementById("inp1").value,
    //         email: document.getElementById("inp2").value,
    //         password: document.getElementById("inp3").value,
    //         username: document.getElementById("inp4").value,
    //         mobile: document.getElementById("inp5").value,
    //         description: document.getElementById("inp6").value,

    //     };
    //     formdata = JSON.stringify(formdata);
    //     //console.log("formdata:",formdata);

    //     fetch("https://masai-api-mocker.herokuapp.com/auth/register",{
    //         method:'POST',
    //         body:formdata,
    //         //additional Info
    //         headers:{
    //             "Content-Type": "application/json",
    //         },

    //     })
    //     .then(function (res) {
    //         res.json().then(function (res) {
    //             console.log("res",res);
                
    //         })
            
    //     })
    //     .catch(function (err) {
    //         console.log("err:", err);
    //     });

        
    // }

    function logOut(){

        fetch("http://localhost:2222/users/logout", {
            method: 'PATCH',
            //body: body,
            //additional Info
            //mode:'no-cors',
            headers: {
                "Content-Type": "application/json",
            },

        })
            .then(function (res) {
                res.json().then(function (res) {
                    console.log("res", res);
                    // let u = formdata.username;
                    // let t = res.token;

                    // getMyProfile(u,t);
                     getUsers();

                })

            })
            .catch(function (err) {
                console.log("err:", err);
            });

       

    }

    function Login(e) {
        e.preventDefault();

        let formdata = {
            username: document.getElementById("inp7").value,
            password: document.getElementById("inp8").value,
        };

        body = JSON.stringify(formdata);
        console.log("formdata:", formdata);

        fetch("http://localhost:2222/users/login", {
            method: 'POST',
            body: body,
            //additional Info
            //mode:'no-cors',
            headers: {
                "Content-Type": "application/json",
            },

        })
        .then(function (res) {
            res.json().then(function (res) {
                console.log("res", res);
                // let u = formdata.username;
                // let t = res.token;

                // getMyProfile(u,t);

            })

        })
        .catch(function (err) {
            console.log("err:", err);
        });


        //token: 545d5f703ca3ac92dfb27d3697ff132c

        
    }

    // function getMyProfile(username,token) {
    //     fetch(`https://masai-api-mocker.herokuapp.com/user/${username}`, {
    //         headers: {
    //             'Authorization': `Bearer ${token}`
    //         }
    //     })
    //     .then(function (res) {
    //         res.json().then(function (res) {
    //             console.log("res", res);

    //         })

    //     })
    //     .catch(function (err) {
    //         console.log("err:", err);
    //     });

    // }  
    
    
    function getUsers() {
        fetch(`http://localhost:2222/users/`, {
            method:'GET',
            //body:formdata,
            //additional Info
            // headers:{
            //     "Content-Type": "application/json",
            // },
        })
        .then(function (res) {
            res.json().then(function (res) {
                console.log("res", res);

            })

        })
        .catch(function (err) {
            console.log("err:", err);
        });

    }

    getUsers();




</script>
<script>

</script>